<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Resultados da Pesquisa</title>
  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="progress-bar"></div>

  <div class="search-container" style="text-align:center; margin-top:20px;">
    <input type="text" id="username" placeholder="Digite o @ do Instagram" style="padding:10px; width:250px;">
    <button onclick="searchInstagram()" style="padding:10px 20px;">Pesquisar</button>
  </div>

  <!-- Console fake hacking -->
  <div id="console-screen" class="hidden"></div>

  <div class="resultados-grid" id="resultados"></div>

  <script>
    function fakeConsoleAnimation(callback) {
      const consoleScreen = document.getElementById("console-screen");
      consoleScreen.classList.remove("hidden");
      const lines = [
        "> Initializing system...",
        "> Connecting to Instagram servers...",
        "> Bypassing firewalls...",
        "> Scanning profile data...",
        "> Decrypting information...",
        "> Extraction complete."
      ];
      let i = 0;
      function typeLine() {
        if (i < lines.length) {
          const p = document.createElement("p");
          p.classList.add("console-line");
          p.textContent = lines[i];
          consoleScreen.appendChild(p);
          i++;
          setTimeout(typeLine, 800);
        } else {
          setTimeout(() => {
            consoleScreen.classList.add("hidden");
            consoleScreen.innerHTML = "";
            callback();
          }, 2000);
        }
      }
      typeLine();
    }

    async function searchInstagram() {
      const username = document.getElementById("username").value.trim();
      if (!username) return alert("Digite um usuário válido");

      fakeConsoleAnimation(async () => {
        try {
          const res = await fetch(`https://www.instagram.com/${username}/?__a=1&__d=dis`);
          if (!res.ok) throw new Error("Erro ao buscar perfil");
          const data = await res.json();

          let user = data.graphql.user;
          const resultados = document.getElementById("resultados");
          resultados.innerHTML = "";

          const card = document.createElement("div");
          card.classList.add("result-card");
          card.innerHTML = `
            <img src="${user.profile_pic_url_hd}" alt="Foto de perfil">
            <h2>@${user.username}</h2>
            <p>${user.biography || ""}</p>
            <p><strong>Seguidores:</strong> ${user.edge_followed_by.count}</p>
            <p><strong>Seguindo:</strong> ${user.edge_follow.count}</p>
            <a href="https://instagram.com/${user.username}" target="_blank">Abrir no Instagram</a>
          `;
          resultados.appendChild(card);
        } catch (err) {
          alert("Não foi possível obter os dados do perfil.");
        }
      });
    }
  </script>
</body>
</html>
